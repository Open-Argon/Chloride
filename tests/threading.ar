import "../stdlib/threading" expose Thread
import "../stdlib/random" expose random

let d(until) = do
  let i = 0
  while (i<until) do
    i=i+1
  return i

while (true) do
  let thread1 = Thread(()=d(random.range(0,100))).start()
  let thread2 = Thread(()=d(random.range(0,100))).start()
  let thread3 = Thread(()=d(random.range(0,100))).start()
  let thread4 = Thread(()=d(random.range(0,100))).start()
  let thread5 = Thread(()=d(random.range(0,100))).start()
  let thread6 = Thread(()=d(random.range(0,100))).start()
  let thread7 = Thread(()=d(random.range(0,100))).start()
  let thread8 = Thread(()=d(random.range(0,100))).start()
  let thread9 = Thread(()=d(random.range(0,100))).start()
  let thread10 = Thread(()=d(random.range(0,100))).start()
  let thread11 = Thread(()=d(random.range(0,100))).start()
  let thread12 = Thread(()=d(random.range(0,100))).start()
  let thread13 = Thread(()=d(random.range(0,100))).start()
  let thread14 = Thread(()=d(random.range(0,100))).start()
  let thread15 = Thread(()=d(random.range(0,100))).start()
  let thread16 = Thread(()=d(random.range(0,100))).start()

  thread1.join()
  thread2.join()
  thread3.join()
  thread4.join()
  thread5.join()
  thread6.join()
  thread7.join()
  thread8.join()
  thread9.join()
  thread10.join()
  thread11.join()
  thread12.join()
  thread13.join()
  thread14.join()
  thread15.join()
  thread16.join()
  term.log("done")