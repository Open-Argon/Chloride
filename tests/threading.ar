import "../stdlib/threading" expose Thread
import "../stdlib/random" expose random

let thread1_result, thread2_result

let d(until, result) = do
  let i = 0
  while (i<until) do
    i=i+1
  result(i)

while (true) do
  let thread = Thread(()=d(random.range(0,1000000),(result)=thread1_result=result)).start()
  let thread2 = Thread(()=d(random.range(0,1000000),(result)=thread2_result=result)).start()

  term.log(thread.join())
  term.log(thread1_result)
  term.log(thread2.join())
  term.log(thread2_result)
  term.log("done")