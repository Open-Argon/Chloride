import "../stdlib/threading" expose Thread

let d() = do
  let i = 0
  while (i<1e6) do
    i=i+1
  return i

let x = 0

let n = 16

while (x<10) do
  let threads = []
  let i = 0
  while (i<n) do
    threads.append(Thread(d).start())
    i=i+1

  i = 0
  while (i<threads.length) do
    term.log(threads[i].join())
    i=i+1

  term.log("done", x)
  x=x+1